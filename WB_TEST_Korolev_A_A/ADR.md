# ADR: Использование Бесконечной Пагинации для Запроса Транзакций

## Контекст

Как пользователь, я хочу иметь возможность открыть страницу, где будут отображены все мои транзакции, совершенные в различных сервисах компании. Технический контекст включает взаимодействие с веб-интерфейсом (WEB UI), который отправляет HTTP-запросы к APIGateway. APIGateway транслирует запросы в сервис BillingService. BillingService взаимодействует с сервисом Balance для получения всех транзакций из центрального хранилища Balance. В случае ошибки при обращении к сервису Balance, BillingService извлекает список транзакций из своей локальной базы данных (БД).

## Решение

Для обеспечения сохранения транзакций в локальной базе данных (LocalDB) в случае возникновения ошибки при обращении к сервису Balance, принято решение использовать бесконечную пагинацию при запросе транзакций.

### Детали Варианта 3: Бесконечная Пагинация

1. **Шаги Взаимодействия:**
   - Пользователь открывает страницу транзакций через веб-интерфейс (WEB UI).
   - WEB UI отправляет HTTP GET-запрос /transactions к APIGateway.
   - APIGateway транслирует запрос в BillingService.
   - BillingService формирует оптимизированный запрос к сервису Balance (HTTP GET /optimized-transactions) с параметром limit=100.
   - Balance возвращает оптимизированные транзакции.
   - BillingService кэширует транзакции в локальной базе данных (LocalDB).

2. **Асинхронная Обработка:**
   - При асинхронной обработке, WEB UI отправляет асинхронный запрос HTTP GET /async-transactions к APIGateway.
   - APIGateway транслирует запрос в BillingService для асинхронной обработки.
   - BillingService подтверждает асинхронную обработку, возвращая временное подтверждение с заголовками X-Request-ID и X-Correlation-ID.

3. **Запрос Следующей Порции Транзакций:**
   - Пользователь запрашивает следующую порцию транзакций через WEB UI.
   - WEB UI отправляет HTTP GET-запрос /next-transactions к APIGateway.
   - APIGateway транслирует запрос в BillingService.
   - BillingService формирует запрос к Balance (HTTP GET /next-transactions) с параметрами from=101 и limit=100.
   - Balance возвращает следующую порцию транзакций.
   - BillingService сохраняет транзакции в локальной базе данных (LocalDB).

### Визуализация

Для визуализации данного варианта использования была создана диаграмма последовательности:
